import {useEffect, useState} from 'react'
import Head from 'next/head'
import Image from 'next/image'
import styles from '../styles/Home.module.css'
import StarRating from '../components/star-rating'
import Header from '../components/Header'
import Link from 'next/link'
const url = 



export async function getStaticProps(){
  try {
     
    const res = await fetch ('https://ghibliapi.herokuapp.com/films')
    const data = await res.json()
    

    return {
      props:{
         data,
        }
    }
  } catch (error){
    console.log(error)
  }
}


export default function Home({data}) {
  
  const [data, setDataState] = useState([])
  const [searchInputInitialState, setSearchInput] = useState('')
  const [filteredResults, setFilteredResults] = useState([])
  useEffect(()=>{
      setDataState(data)
  })

  
  return (
     <div className={styles.home_container}>
      <Head>
        <title>STUDIO GHIBLI</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
        <link rel="preconnect" href="https://fonts.googleapis.com"/>
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
        <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300&family=Crimson+Pro:wght@200;400&family=Nunito&family=Nunito+Sans&family=Quicksand:wght@500;700&family=Roboto:ital,wght@0,100;1,100&display=swap" rel="stylesheet"/>

      </Head>
      <Header showFilterBtn showSearchBtn showUserLink/> 
      
      {
        searchInputInitialState.length > 1 ? (
          filteredResults.map((movies)=>{
            return(
              <article key={movies.id} className={styles.movie_card_container}>
                <section className={styles.movie_card_img}>
                  <img src={movies.image}></img>
                  </section>
                  <section className={styles.movie_card_description}>
                 <h3>{movies.title}</h3>
                 <h4>{movies.release_date}</h4>
                 <p>{movies.description}</p>  
                 </section>
                 <StarRating/>
              </article>
            )
          })
        ) : (
          data.map((movies) =>{
            return (
              <article key={movies.id}className={styles.movie_card_container}>
                <section className={styles.movie_card_img}>
                 <img src={movies.image}></img>
                 </section>
                 <section className={styles.movie_card_description}>
                 <h3>{movies.title}</h3>
                 <h4>{movies.release_date}</h4>
                 <p>{movies.description}</p>
                 </section>
                 <StarRating/>  
              </article>
              
            )
          })
        )
      }
       <Footer/>
      
    </div>  
  )
    }


const Footer = () =>{
  return (
    <Link href="/login">
      <a> 
        <div className={styles.btn_container}>
        <button className={styles.button}>Suscribe!</button> 
        
        </div>
        </a>
        </Link>
  )}

 
  
  